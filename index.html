<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Seating Finder (No images)</title>
  <style>
    :root{
      --bg:#0b0d12; --panel:#121726; --panel2:#0f1422; --text:#e7eaf2; --muted:#a9b0c3;
      --accent:#7aa2ff; --border:rgba(255,255,255,.10); --shadow:0 16px 40px rgba(0,0,0,.45);
      --seat:#223056; --seat2:#1a2443; --hl:#7aa2ff;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:radial-gradient(1200px 600px at 10% 0%,#131a35 0%,var(--bg) 55%) fixed;color:var(--text)}
    header{padding:18px 18px 10px;border-bottom:1px solid var(--border);background:rgba(18,23,38,.55);backdrop-filter:blur(10px);position:sticky;top:0;z-index:50}
    h1{margin:0;font-size:18px;font-weight:800}
    .sub{margin-top:6px;color:var(--muted);font-size:13px}
    .tabs{display:flex;gap:8px;margin-top:12px;flex-wrap:wrap}
    .tab-btn{appearance:none;border:1px solid var(--border);background:rgba(15,20,34,.65);color:var(--text);padding:10px 12px;border-radius:12px;cursor:pointer;font-weight:700;font-size:13px}
    .tab-btn.active{background:rgba(122,162,255,.18);border-color:rgba(122,162,255,.55)}
    main{padding:16px 18px 28px;display:grid;grid-template-columns:420px 1fr;gap:14px;align-items:start}
    @media (max-width:980px){main{grid-template-columns:1fr}}
    .card{border:1px solid var(--border);border-radius:18px;background:linear-gradient(180deg,rgba(18,23,38,.85),rgba(15,20,34,.70));box-shadow:var(--shadow);overflow:hidden}
    .card-h{padding:12px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;gap:10px;background:rgba(10,12,18,.15)}
    .title{font-size:13px;font-weight:900;letter-spacing:.3px}
    .card-b{padding:12px}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .input{width:100%;padding:11px 12px;border-radius:14px;border:1px solid var(--border);background:rgba(10,12,18,.35);color:var(--text);outline:none;font-size:14px}
    .select{padding:10px 12px;border-radius:14px;border:1px solid var(--border);background:rgba(10,12,18,.35);color:var(--text);outline:none;font-size:14px;cursor:pointer}
    .pill{display:inline-flex;align-items:center;gap:8px;padding:8px 10px;border:1px solid var(--border);border-radius:999px;background:rgba(10,12,18,.35);color:var(--muted);font-size:12px;user-select:none}
    .pill b{color:var(--text)}
    .list{margin-top:10px;display:grid;gap:8px}
    .item{border:1px solid var(--border);border-radius:14px;background:rgba(10,12,18,.28);padding:10px;cursor:pointer}
    .item:hover{border-color:rgba(122,162,255,.40);background:rgba(10,12,18,.36)}
    .top{display:flex;justify-content:space-between;gap:10px;align-items:baseline}
    .team{font-weight:900;font-size:14px}
    .seat{font-weight:900;font-size:14px;color:var(--accent)}
    .meta{margin-top:5px;color:var(--muted);font-size:12px;line-height:1.25}
    .hint{margin-top:10px;color:var(--muted);font-size:12px;line-height:1.35}

    /* SVG plan */
    .plan-wrap{border:1px solid var(--border);border-radius:16px;overflow:hidden;background:rgba(10,12,18,.25)}
    svg{display:block;width:100%;height:auto}
    .seat-node{cursor:pointer}
    .seat-circle{fill:rgba(34,48,86,.9);stroke:rgba(255,255,255,.18);stroke-width:1.2}
    .seat-label{fill:rgba(231,234,242,.92);font-weight:900;font-size:10px;text-anchor:middle;dominant-baseline:middle;user-select:none}
    .seat-hl .seat-circle{fill:rgba(122,162,255,.55);stroke:rgba(255,255,255,.92);stroke-width:2.5}
    .seat-hl .seat-label{fill:#fff}
    .legend{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    .dot{width:10px;height:10px;border-radius:999px;display:inline-block;vertical-align:middle}
  </style>
</head>
<body>
<header>
  <h1>Seating Finder</h1>
  <div class="sub">No images: the plan is drawn as an interactive map. Type your team name (aliases work).</div>
  <div class="tabs" id="tabs"></div>
</header>

<main>
  <section class="card">
    <div class="card-h">
      <div class="title">Search</div>
      <span class="pill">Matches: <b id="matchCount">0</b></span>
    </div>
    <div class="card-b">
      <input id="q" class="input" placeholder="Start typing your team name… (aliases work too)" autocomplete="off" />
      <div class="row" style="margin-top:10px;">
        <select id="roomSelect" class="select"></select>
        <span class="pill">Room: <b id="roomName">—</b></span>
      </div>
      <div class="list" id="list"></div>
      <div class="hint">Click a team row to highlight the seat on the plan.</div>
    </div>
  </section>

  <section class="card">
    <div class="card-h">
      <div class="title">Room plan (SVG)</div>
      <span class="pill">Selected: <b id="selectedInfo">—</b></span>
    </div>
    <div class="card-b">
      <div class="plan-wrap" id="planWrap"></div>

      <div class="legend">
        <span class="pill"><span class="dot" style="background:rgba(34,48,86,.9)"></span>&nbsp;Seat</span>
        <span class="pill"><span class="dot" style="background:rgba(122,162,255,.55)"></span>&nbsp;Highlighted</span>
      </div>
    </div>
  </section>
</main>

<script>
const CONFIG = {
  rooms: [
    {
      id: "1",
      name: "602",
      seats: {
        "1":  { x: 10, y: 80 },
        "2":  { x: 10, y: 68 },
        "3":  { x: 10, y: 56 },
        "4":  { x: 10, y: 44 },
        "5":  { x: 10, y: 32 },

        "6":  { x: 36, y: 80 },
        "7":  { x: 36, y: 70 },
        "8":  { x: 36, y: 64 },
        "9":  { x: 36, y: 58 },
        "10": { x: 36, y: 54 },

        "11": { x: 36, y: 48 },
        "12": { x: 36, y: 44 },
        "13": { x: 36, y: 38 },
        "14": { x: 36, y: 34 },
        "15": { x: 36, y: 28 },

        "16": { x: 65, y: 80 },
        "17": { x: 65, y: 68 },
        "18": { x: 65, y: 56 },
        "19": { x: 65, y: 44 },
        "20": { x: 65, y: 32 },
      }
    },
    {
      id: "2",
      name: "603",
      seats: {
        "21": { x: 12, y: 92 },
        "22": { x: 22, y: 92 },
        "23": { x: 32, y: 92 },
        "24": { x: 42, y: 92 },

        "25": { x: 56, y: 80 },
        "26": { x: 56, y: 68 },
        "27": { x: 56, y: 56 },
        "28": { x: 56, y: 44 },
        "29": { x: 56, y: 32 },
        "30": { x: 56, y: 20 },
        "31": { x: 56, y: 8 },

        "32": { x: 68, y: 82 },
        "33": { x: 68, y: 78 },
        "34": { x: 68, y: 72 },
        "35": { x: 68, y: 68 },
        "36": { x: 68, y: 62 },
        "37": { x: 68, y: 58 },
        "38": { x: 68, y: 52 },
        "39": { x: 68, y: 46 },
        "40": { x: 68, y: 42 },
        "41": { x: 68, y: 36 },
        "42": { x: 68, y: 32 },
        "43": { x: 68, y: 26 },

        "44": { x: 88, y: 80 },
        "45": { x: 88, y: 68 },
        "46": { x: 88, y: 56 },
        "47": { x: 88, y: 44 },
        "48": { x: 88, y: 32 },
        "49": { x: 88, y: 20 },
      }
    }
  ],

  contests: [
    {
      id: "contestA",
      name: "Teams",
      teams: [
  { seat: "1",  team: "Rasul Gasimli",              aliases: ["Rasul Gasimli"],              roomId: "1" },
  { seat: "2",  team: "Nika Tamliani",              aliases: ["Nika Tamliani"],              roomId: "1" },
  { seat: "3",  team: "Robert Kocharyan",           aliases: ["Robert Kocharyan"],           roomId: "1" },
  { seat: "4",  team: "Ravan Sadigzade",            aliases: ["Ravan Sadigzade"],            roomId: "1" },
  { seat: "5",  team: "Otar Kukhianidze",           aliases: ["Otar Kukhianidze"],           roomId: "1" },
  { seat: "6",  team: "Nijat Alaskarli",            aliases: ["Nijat Alaskarli"],            roomId: "1" },
  { seat: "7",  team: "Tsovak Yegoryan",            aliases: ["Tsovak Yegoryan"],            roomId: "1" },
  { seat: "8",  team: "Aliyyiakbar Shirinli",       aliases: ["Aliyyiakbar Shirinli"],       roomId: "1" },
  { seat: "9",  team: "Tigran Sargsyan",            aliases: ["Tigran Sargsyan"],            roomId: "1" },
  { seat: "10", team: "Emin Orujov",                aliases: ["Emin Orujov"],                roomId: "1" },
  { seat: "11", team: "Yusif Abbaszade",            aliases: ["Yusif Abbaszade"],            roomId: "1" },
  { seat: "12", team: "Vugar Guliyev",              aliases: ["Vugar Guliyev"],              roomId: "1" },
  { seat: "13", team: "Saleh Isayev",               aliases: ["Saleh Isayev"],               roomId: "1" },
  { seat: "14", team: "None",                       aliases: [],                             roomId: "1" },
  { seat: "15", team: "None",                       aliases: [],                             roomId: "1" },
  { seat: "16", team: "Amaras Nazarians",           aliases: ["Amaras Nazarians"],           roomId: "1" },
  { seat: "17", team: "Razmik Parzyan",             aliases: ["Razmik Parzyan"],             roomId: "1" },
  { seat: "18", team: "Anar Bastanov",              aliases: ["Anar Bastanov"],              roomId: "1" },
  { seat: "19", team: "Luka Turabelidze",           aliases: ["Luka Turabelidze"],           roomId: "1" },
  { seat: "20", team: "Stepan Gevorgyan",           aliases: ["Stepan Gevorgyan"],           roomId: "1" },
  { seat: "21", team: "None",                       aliases: [],                             roomId: "1" },
  { seat: "22", team: "Garnik Khroyan",             aliases: ["Garnik Khroyan"],             roomId: "1" },
  { seat: "23", team: "Rasul Ismayilzade",          aliases: ["Rasul Ismayilzade"],          roomId: "1" },
  { seat: "24", team: "Davit Bakhshyan",            aliases: ["Davit Bakhshyan"],            roomId: "1" },
  { seat: "25", team: "Hayk Petrosyan",             aliases: ["Hayk Petrosyan"],             roomId: "1" },
  { seat: "26", team: "Mahammad Hasanov",           aliases: ["Mahammad Hasanov"],           roomId: "1" },
  { seat: "27", team: "Narek Gharagyozyan",         aliases: ["Narek Gharagyozyan"],         roomId: "1" },
  { seat: "28", team: "Hrayr Barseghyan",           aliases: ["Hrayr Barseghyan"],           roomId: "1" },
  { seat: "29", team: "Tevdore Nadareishvili",      aliases: ["Tevdore Nadareishvili"],      roomId: "1" },
  { seat: "30", team: "Tahir Aliyev",               aliases: ["Tahir Aliyev"],               roomId: "1" },
  { seat: "31", team: "Aram Karakeshishyan",        aliases: ["Aram Karakeshishyan"],        roomId: "1" },
  { seat: "32", team: "Movlan Amanov",              aliases: ["Movlan Amanov"],              roomId: "1" },
  { seat: "33", team: "Levan Namicheishvili",       aliases: ["Levan Namicheishvili"],       roomId: "1" },
  { seat: "34", team: "Dachi Suramelashvili",       aliases: ["Dachi Suramelashvili"],       roomId: "1" },
  { seat: "35", team: "Anri Arkania",               aliases: ["Anri Arkania"],               roomId: "1" },
  { seat: "36", team: "Nizami Taghizada",           aliases: ["Nizami Taghizada"],           roomId: "1" },
  { seat: "37", team: "Shamil Mantashli",           aliases: ["Shamil Mantashli"],           roomId: "1" },
  { seat: "38", team: "Alimdar Musayev",            aliases: ["Alimdar Musayev"],            roomId: "1" },
  { seat: "39", team: "Hamlet Petrosyan",           aliases: ["Hamlet Petrosyan"],           roomId: "1" },
  { seat: "40", team: "Shamil Aliyev",              aliases: ["Shamil Aliyev"],              roomId: "1" },
  { seat: "41", team: "Javad Gurbanov",             aliases: ["Javad Gurbanov"],             roomId: "1" },
  { seat: "42", team: "Sadig Malikov",              aliases: ["Sadig Malikov"],              roomId: "1" },
  { seat: "43", team: "None",                       aliases: [],                             roomId: "1" },
  { seat: "44", team: "Gulmirza Aliyev",            aliases: ["Gulmirza Aliyev"],            roomId: "1" },
  { seat: "45", team: "Ulvi Sadigzade",             aliases: ["Ulvi Sadigzade"],             roomId: "1" },
  { seat: "46", team: "Sahib Aliyev",               aliases: ["Sahib Aliyev"],               roomId: "1" },
  { seat: "47", team: "Samvel Andreasyan",          aliases: ["Samvel Andreasyan"],          roomId: "1" },
  { seat: "48", team: "Jamil Jamaladdinli",         aliases: ["Jamil Jamaladdinli"],         roomId: "1" },
  { seat: "49", team: "Sergey Grigoryan",           aliases: ["Sergey Grigoryan"],           roomId: "1" },
  { seat: "50", team: "Huseyn Aghayev",             aliases: ["Huseyn Aghayev"],             roomId: "1" },
  { seat: "51", team: "Aleqsandre Dolaqidze",       aliases: ["Aleqsandre Dolaqidze"],       roomId: "1" },
  { seat: "52", team: "None",                       aliases: [],                             roomId: "1" },
  { seat: "53", team: "Mher Aghayan",               aliases: ["Mher Aghayan"],               roomId: "1" },
  { seat: "54", team: "Armen Berujanyan",           aliases: ["Armen Berujanyan"],           roomId: "1" }
]

    },
    {
      id: "contestB",
      name: "Individual",
      teams: [

  { seat: "1",  team: "Samvel Andreasyan",        aliases: ["Samvel Andreasyan"],        roomId: "1" },
  { seat: "2",  team: "Aram Karakeshishyan",      aliases: ["Aram Karakeshishyan"],      roomId: "1" },
  { seat: "3",  team: "Robert Kocharyan",         aliases: ["Robert Kocharyan"],         roomId: "1" },
  { seat: "4",  team: "Sahib Aliyev",             aliases: ["Sahib Aliyev"],             roomId: "1" },
  { seat: "5",  team: "Hamlet Petrosyan",         aliases: ["Hamlet Petrosyan"],         roomId: "1" },
  { seat: "6",  team: "Nijat Alaskarli",          aliases: ["Nijat Alaskarli"],          roomId: "1" },
  { seat: "7",  team: "Mher Aghayan",             aliases: ["Mher Aghayan"],             roomId: "1" },
  { seat: "8",  team: "Tahir Aliyev",             aliases: ["Tahir Aliyev"],             roomId: "1" },
  { seat: "9",  team: "Tigran Sargsyan",          aliases: ["Tigran Sargsyan"],          roomId: "1" },
  { seat: "10", team: "Sahib Aliyev",             aliases: ["Sahib Aliyev"],             roomId: "1" },
  { seat: "11", team: "Aliyyiakbar Shirinli",     aliases: ["Aliyyiakbar Shirinli"],     roomId: "1" },
  { seat: "12", team: "Stepan Gevorgyan",         aliases: ["Stepan Gevorgyan"],         roomId: "1" },
  { seat: "13", team: "Nijat Alaskarli",          aliases: ["Nijat Alaskarli"],          roomId: "1" },
  { seat: "14", team: "None",                     aliases: [],                           roomId: "1" },
  { seat: "15", team: "None",                     aliases: [],                           roomId: "1" },
  { seat: "16", team: "Huseyn Aghayev",           aliases: ["Huseyn Aghayev"],           roomId: "1" },
  { seat: "17", team: "Razmik Parzyan",           aliases: ["Razmik Parzyan"],           roomId: "1" },
  { seat: "18", team: "Tahir Aliyev",             aliases: ["Tahir Aliyev"],             roomId: "1" },
  { seat: "19", team: "Sergey Grigoryan",         aliases: ["Sergey Grigoryan"],         roomId: "1" },
  { seat: "20", team: "Rasul Gasimli",            aliases: ["Rasul Gasimli"],            roomId: "1" },

  { seat: "21", team: "None",                     aliases: [],                           roomId: "2" },
  { seat: "22", team: "Garnik Khroyan",           aliases: ["Garnik Khroyan"],           roomId: "2" },
  { seat: "23", team: "Davit Bakhshyan",          aliases: ["Davit Bakhshyan"],          roomId: "2" },
  { seat: "24", team: "Khizri Sakhrayev",         aliases: ["Khizri Sakhrayev"],         roomId: "2" },
  { seat: "25", team: "Hayk Petrosyan",           aliases: ["Hayk Petrosyan"],           roomId: "2" },
  { seat: "26", team: "Mahammad Hasanov",         aliases: ["Mahammad Hasanov"],         roomId: "2" },
  { seat: "27", team: "Movlan Amanov",            aliases: ["Movlan Amanov"],            roomId: "2" },
  { seat: "28", team: "Hrayr Barseghyan",         aliases: ["Hrayr Barseghyan"],         roomId: "2" },
  { seat: "29", team: "Ravan Sadigzade",          aliases: ["Ravan Sadigzade"],          roomId: "2" },
  { seat: "30", team: "Nizami Taghizada",         aliases: ["Nizami Taghizada"],         roomId: "2" },
  { seat: "31", team: "Luka Turabelidze",         aliases: ["Luka Turabelidze"],         roomId: "2" },
  { seat: "32", team: "Narek Gharagyozyan",       aliases: ["Narek Gharagyozyan"],       roomId: "2" },
  { seat: "33", team: "Levan Namicheishvili",     aliases: ["Levan Namicheishvili"],     roomId: "2" },
  { seat: "34", team: "Dachi Suramelashvili",     aliases: ["Dachi Suramelashvili"],     roomId: "2" },
  { seat: "35", team: "Anri Arkania",             aliases: ["Anri Arkania"],             roomId: "2" },
  { seat: "36", team: "Anar Bastanov",            aliases: ["Anar Bastanov"],            roomId: "2" },
  { seat: "37", team: "Shamil Mantashli",         aliases: ["Shamil Mantashli"],         roomId: "2" },
  { seat: "38", team: "Alimdar Musayev",          aliases: ["Alimdar Musayev"],          roomId: "2" },
  { seat: "39", team: "Otar Kukhianidze",         aliases: ["Otar Kukhianidze"],         roomId: "2" },
  { seat: "40", team: "Shamil Aliyev",            aliases: ["Shamil Aliyev"],            roomId: "2" },
  { seat: "41", team: "Javad Gurbanov",           aliases: ["Javad Gurbanov"],           roomId: "2" },
  { seat: "42", team: "Sadig Malikov",            aliases: ["Sadig Malikov"],            roomId: "2" },
  { seat: "43", team: "None",                     aliases: [],                           roomId: "2" },
  { seat: "44", team: "Gulmirza Aliyev",          aliases: ["Gulmirza Aliyev"],          roomId: "2" },
  { seat: "45", team: "Ulvi Sadigzade",           aliases: ["Ulvi Sadigzade"],           roomId: "2" },
  { seat: "46", team: "Tevdore Nadareishvili",    aliases: ["Tevdore Nadareishvili"],    roomId: "2" },
  { seat: "47", team: "Vugar Guliyev",            aliases: ["Vugar Guliyev"],            roomId: "2" },
  { seat: "48", team: "Yusif Abbaszade",          aliases: ["Yusif Abbaszade"],          roomId: "2" },
  { seat: "49", team: "Nika Tamliani",            aliases: ["Nika Tamliani"],            roomId: "2" }

      ]
    }
  ]
};

// ---------- APP ----------
const elTabs = document.getElementById("tabs");
const elQ = document.getElementById("q");
const elList = document.getElementById("list");
const elMatchCount = document.getElementById("matchCount");
const elRoomSelect = document.getElementById("roomSelect");
const elRoomName = document.getElementById("roomName");
const elPlanWrap = document.getElementById("planWrap");
const elSelectedInfo = document.getElementById("selectedInfo");

let state = { contestId: CONFIG.contests[0]?.id ?? null, roomId: null, query: "", selectedSeat: null };

function norm(s){ return (s ?? "").toString().trim().toLowerCase().replace(/\s+/g," "); }
function escapeHtml(s){
  return (s ?? "").toString()
    .replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;")
    .replaceAll('"',"&quot;").replaceAll("'","&#039;");
}
function getContest(){
  return CONFIG.contests.find(c => c.id === state.contestId) ?? CONFIG.contests[0];
}
function getRoomById(roomId){
  return CONFIG.rooms.find(r => r.id === roomId) ?? CONFIG.rooms[0];
}
function getCurrentRoom(){
  return getRoomById(state.roomId ?? CONFIG.rooms[0]?.id);
}

function matchesTeam(t, qn){
  if(!qn) return true;
  const all = [t.team, ...(t.aliases ?? [])].map(norm);
  return all.some(x=>x.includes(qn));
}

function renderTabs(){
  elTabs.innerHTML = "";
  for(const c of CONFIG.contests){
    const b = document.createElement("button");
    b.className = "tab-btn" + (c.id===state.contestId ? " active" : "");
    b.textContent = c.name;
    b.onclick = ()=>{
      state.contestId = c.id;
      state.roomId = null;
      state.selectedSeat = null;
      state.query = "";
      elQ.value = "";
      renderAll();
    };
    elTabs.appendChild(b);
  }
}

function renderRoomSelect(){
  elRoomSelect.innerHTML = "";
  for(const r of CONFIG.rooms){
    const o = document.createElement("option");
    o.value = r.id;
    o.textContent = r.name;
    elRoomSelect.appendChild(o);
  }

  // keep current room if possible
  const room = getCurrentRoom();
  state.roomId = room.id;
  elRoomSelect.value = room.id;
  elRoomName.textContent = room.name;

  elRoomSelect.onchange = () => {
    state.roomId = elRoomSelect.value;
    state.selectedSeat = null;
    renderAll();
  };
}

function renderList(contest){
  const qn = norm(state.query);

  const teams = contest.teams
    .filter(t => matchesTeam(t, qn))
    .sort((a,b)=>norm(a.team).localeCompare(norm(b.team)));

  elMatchCount.textContent = teams.length;
  elList.innerHTML = "";

  if(teams.length === 0){
    const div = document.createElement("div");
    div.className = "item";
    div.style.cursor = "default";
    div.innerHTML = `<div class="top"><div class="team">No matches</div><div class="seat">—</div></div>
      <div class="meta">Try another room or a different alias.</div>`;
    elList.appendChild(div);
    return;
  }

  for(const t of teams){
    const r = getRoomById(t.roomId);

    const div = document.createElement("div");
    div.className = "item";
    div.innerHTML = `
      <div class="top">
        <div class="team">${escapeHtml(t.team)}</div>
        <div class="seat">Seat ${escapeHtml(t.seat)}</div>
      </div>
      <div class="meta">
        Room: <b>${escapeHtml(r.name)}</b>
        ${t.aliases?.length ? `<br/>Aliases: ${t.aliases.map(escapeHtml).join(", ")}` : ""}
      </div>
    `;

    div.onclick = () => {
      // AUTO SWITCH ROOM
      state.roomId = t.roomId;
      elRoomSelect.value = t.roomId;
      elRoomName.textContent = r.name;

      state.selectedSeat = { team: t.team, seat: t.seat };
      elSelectedInfo.textContent = `${t.team} — ${r.name}, seat ${t.seat}`;
      renderPlan(contest, r);
    };

    elList.appendChild(div);
  }
}

function renderPlan(contest, room){
  const seats = room.seats ?? {};
  const selectedSeat = state.selectedSeat?.seat ?? null;

  // Config you can tune per room if you want
  const gridStep = room.gridStep ?? 10;     // grid every N units (0..100)
  const seatR = room.seatR ?? 2.2;          // seat dot radius
  const fontSize = room.fontSize ?? 3.2;    // SMALL numbers
  const showNumbers = room.showNumbers ?? true; // you can set false if you want only dots

  // SVG in 0..100 so your x/y percent coordinates match
  let svg = `
  <svg viewBox="0 0 100 100" role="img" aria-label="Room plan">
    <defs>
      <pattern id="grid" width="${gridStep}" height="${gridStep}" patternUnits="userSpaceOnUse">
        <path d="M ${gridStep} 0 L 0 0 0 ${gridStep}" fill="none" stroke="rgba(255,255,255,0.06)" stroke-width="0.5"/>
      </pattern>
      <filter id="glow">
        <feGaussianBlur stdDeviation="0.7" result="blur"/>
        <feMerge>
          <feMergeNode in="blur"/>
          <feMergeNode in="SourceGraphic"/>
        </feMerge>
      </filter>
    </defs>

    <rect x="1" y="1" width="98" height="98" rx="6" ry="6"
          fill="rgba(10,12,18,0.15)" stroke="rgba(255,255,255,0.10)" />
    <rect x="1" y="1" width="98" height="98" rx="6" ry="6"
          fill="url(#grid)" />

    <text x="4" y="7" fill="rgba(169,176,195,0.95)" font-size="4" font-weight="800">
      ${escapeHtml(room.name)}
    </text>
  `;

  // Draw seats
  for(const seatNum of Object.keys(seats).sort((a,b)=>Number(a)-Number(b))){
    const p = seats[seatNum];
    const isHL = selectedSeat && String(seatNum) === String(selectedSeat);

    // highlight ring
    if (isHL) {
      svg += `
        <circle
          cx="${p.x}"
          cy="${p.y}"
          r="${seatR + 4.0}"
          fill="none"
          stroke="rgba(122,162,255,0.95)"
          stroke-width="1.6"
          stroke-dasharray="3 2"
        />
      `;
    }


    // seat dot
    svg += `
      <g class="seat-node ${isHL ? "seat-hl" : ""}" data-seat="${escapeHtml(seatNum)}">
        <circle
          cx="${p.x}"
          cy="${p.y}"
          r="${seatR}"
          fill="rgba(20,28,48,0.95)"
          stroke="rgba(255,255,255,0.25)"
          stroke-width="1"
        />
        <text
          x="${p.x}"
          y="${p.y}"
          fill="#ffffff"
          font-weight="900"
          font-size="${fontSize}"
          text-anchor="middle"
          dominant-baseline="middle"
          style="pointer-events:none; user-select:none;"
        >
          ${escapeHtml(seatNum)}
        </text>
      </g>
    `;


  }

  svg += `</svg>`;
  elPlanWrap.innerHTML = svg;

  // Hover tooltip (HTML overlay)
  // Ensure planWrap is position:relative (add in CSS if not already)
  elPlanWrap.style.position = "relative";

  // remove old tooltip if any
  elPlanWrap.querySelectorAll(".seat-tip").forEach(n => n.remove());

  const tip = document.createElement("div");
  tip.className = "seat-tip";
  tip.style.position = "absolute";
  tip.style.padding = "6px 8px";
  tip.style.borderRadius = "10px";
  tip.style.border = "1px solid rgba(255,255,255,0.14)";
  tip.style.background = "rgba(10,12,18,0.82)";
  tip.style.boxShadow = "0 14px 30px rgba(0,0,0,0.45)";
  tip.style.fontSize = "12px";
  tip.style.fontWeight = "800";
  tip.style.color = "rgba(231,234,242,0.95)";
  tip.style.pointerEvents = "none";
  tip.style.display = "none";
  tip.style.transform = "translate(-50%, -120%)";
  tip.style.zIndex = "10";
  tip.textContent = "";
  elPlanWrap.appendChild(tip);

  // helper: percent -> px inside wrapper
  function placeTip(px, py, text){
    tip.style.left = px + "px";
    tip.style.top = py + "px";
    tip.textContent = text;
    tip.style.display = "block";
  }

  const svgEl = elPlanWrap.querySelector("svg");
  const nodes = elPlanWrap.querySelectorAll(".seat-node");

  // click seat to select
  svgEl.addEventListener("click", (e)=>{
    const g = e.target.closest?.(".seat-node");
    if(!g) return;
    const seat = g.getAttribute("data-seat");
    state.selectedSeat = { team: "(selected seat)", seat };
    elSelectedInfo.textContent = `${room.name}, seat ${seat}`;
    renderPlan(contest, room);
  });

  // hover tooltip
  nodes.forEach(g => {
    g.addEventListener("mousemove", (e) => {
      const rect = elPlanWrap.getBoundingClientRect();
      const seat = g.getAttribute("data-seat");
      // use mouse position so tooltip feels natural
      placeTip(e.clientX - rect.left, e.clientY - rect.top, `Seat ${seat}`);
    });
    g.addEventListener("mouseleave", () => {
      tip.style.display = "none";
    });
  });
}


function renderAll(){
  renderTabs();
  const contest = getContest();

  renderRoomSelect();

  const room = getCurrentRoom();
  elRoomName.textContent = room.name;

  renderList(contest);
  renderPlan(contest, room);

  if(!state.selectedSeat) elSelectedInfo.textContent = "—";
}

elQ.addEventListener("input", ()=>{
  state.query = elQ.value;
  const contest = getContest();

  // compute matches across all rooms
  const qn = norm(state.query);
  const matches = contest.teams.filter(t => matchesTeam(t, qn));

  // if exactly one match -> auto switch + highlight
  if (qn && matches.length === 1) {
    const t = matches[0];
    const r = getRoomById(t.roomId);

    state.roomId = t.roomId;
    state.selectedSeat = { team: t.team, seat: t.seat };

    elRoomSelect.value = t.roomId;
    elRoomName.textContent = r.name;
    elSelectedInfo.textContent = `${t.team} — ${r.name}, seat ${t.seat}`;

    renderList(contest);
    renderPlan(contest, r);
    return;
  }

  renderList(contest);
});


renderAll();
</script>
</body>
</html>
